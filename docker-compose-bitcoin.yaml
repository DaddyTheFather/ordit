version: "3.8"

services:
  bitcoin-core:
    image: ruimarinho/bitcoin-core
    container_name: ordit-bitcoin-server
    ports:
      - ${RPC_PORT}:${RPC_PORT}
    volumes:
      - ./.bitcoin:/home/bitcoin/.bitcoin
    command: -printtoconsole
      -txindex=1
      -testnet=1
      -rpcallowip=0.0.0.0/0
      -rpcbind=0.0.0.0
      -rpcuser='${RPC_USER}'
      -rpcpassword='${RPC_PASSWORD}'
      -blocknotify='curl http://host.docker.internal:${UTXO_PARSER_PORT}/hooks/blockchain?block=%s'
